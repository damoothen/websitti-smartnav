!function(a){a.fn.smartnav=function(b){var c={linksSelector:"a",duration:1e3,updateHistory:!0,selectClass:"selected",offsetTop:0,reference:null};return b=a.extend({},c,b),this.each(function(c){var d=a(this),e=a(b.linksSelector,d),f=a(window),g=a(document),h=a(null!==b.reference?b.reference:window),i=[],j=null,k=null,l=function(a){b.updateHistory&&(history.pushState?history.pushState(null,null,a):location.hash=a)};e.removeClass(b.selectClass),a(e.get(0)).addClass(b.selectClass),e.each(function(b,c){var d=a(this).attr("href");"#"===d.charAt(0)&&i.push(d)}),h.scroll(function(c){var m=h.scrollTop(),n=null;if(0===m)n=a("#"===i[0]?"body":i[0]),0===n.offset().top&&(k=i[0]);else if(!b.reference&&m+h.height()>=g.height())n=a(i[i.length-1]),n.offset().top+n.outerHeight()>=g.height()&&(k=i[i.length-1]);else for(var o in i){n=a("#"===i[o]?"body":i[o]);var p=b.reference?n.position().top:n.offset().top;m>p-f.height()/2&&(k=i[o])}j!==k&&(j=k,e.removeClass(b.selectClass),a('a[href="'+j+'"]',d).addClass(b.selectClass),l(j))}),e.click(function(c){c.preventDefault();var d=0;if(j=a(this).attr("href"),!j||"#"!==j.charAt(0))return!1;"#"!==j&&(d=b.reference?a(j).position().top:a(j).offset().top);var e=b.reference?h:a("body,html");e.animate({scrollTop:d-b.offsetTop},b.duration),l(j)})})}}(jQuery);